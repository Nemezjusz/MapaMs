<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Generated link</title>
    <link rel="stylesheet" href="templates/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

  </head>
<body>
    <!-- mapa -->
      <div class="map-container" id="map-container">
        <img src="images/mapatest4.png" alt="Responsive Image" id="mapa">
        {% for row in rows %}
          
          {{('<img src="images/pin3.png" class="marker" id="marker'~row.id~'" onclick="showPopup('~row.id~')">')|raw}} 
          
          {{('<div id="popup'~row.id~'" class="popup">')|raw}} 
            <p>ID: {{row.id}}</p>
            <p>Imie: {{row.author_name}}</p>
            <p>Opis: {{row.desc}}</p>
            {{('<button onclick="hidePopup('~row.id~')">Close</button>')|raw}} 
          </div>

          {# style="left: '~row.loc_x~'px; top: '~row.loc_y~'px #}
          <script>
            var img = document.getElementById('mapa');
            document.getElementById("map-container").scrollLeft = 0.43*img.clientWidth;

            var ratio = 1080 / (img.clientHeight);
            var x = '{{row.loc_x}}';
            var y = '{{row.loc_y}}';
            var id = '{{row.id}}';

            var marker = document.getElementById("marker"+String(id))
            marker.style.left = (x/ratio) + "px";
            marker.style.top = (y/ratio) + "px";

            function showPopup(id) {
              var popup = document.getElementById("popup"+String(id));
              popup.style.display = "block";
            }

            function hidePopup(id) {
              var popup = document.getElementById("popup"+String(id));
              popup.style.display = "none";
            }

          </script>
          
          
        {% endfor %}
        
      </div>

</body>
</html>

